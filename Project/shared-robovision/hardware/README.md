The demo video in the Youtube:

Using zedboard chaning the BGR format to HSV format.
https://www.youtube.com/watch?v=gzL8fef96NY

Using zedboard chaning the BGR format to HSV format, then set the H threshold the find the red colour.
https://www.youtube.com/watch?v=HWQ5UchrgNM

	For the [rgb2hsv_range_erode_dilate] , [rgb2hsv_range_erode_dilate_Gausiblur] function,
	which need more program logic board to realize the function,like zc706. The simulation 
	can be found in the file ./sw

1. Execute the file directly.

	-- copy the sd_image file to the SD card.
		|-- sd_image/
		|-- sd_image_rgb2hsv        #change the image format from rgb to hsv
		|-- sd_image_rgb2hsv_range  #change the image format from rgb to hsv, set Hin threshold,  
									 remove anything not red
		|-- sd_image_rgb2hsv_range_erode
									#change the image format from rgb to hsv, set Hin threshold, 
									 remove anything not red,then erode the image.
		|-- sd_image_fastC			#fast corner detection (backup for other image process)

			For the [rgb2hsv_range_erode_dilate] , [rgb2hsv_range_erode_dilate_Gausiblur] function,
			which need more program logic board to realize the function,like zc706. The simulation 
			can be found in the file ./sw
	
	-- Configure ZedBoard for SD card boot mode
	   JP7 : MIO2 = GND
	   JP8 : MIO3 = GND
	   JP9 : MIO4 = VCC
	   JP10: MIO5 = VCC
	   JP11: MIO6 = GND
	-- Connect Video Input Source
	   -- Connect VITA-2000 camera module to FMC-IMAGEON's LCEDI connector (CONN200)
	-- Connect 1080P60 capable monitor (have to be 1920*1080 resolution!)
	   -- Connect one end of HDMI cable to ZedBoard's HDMI OUT connector (J9)
	   -- Connect the other end of HDMI cable to the monitor's HDMI or DVI input
	-- Connect USB cable for USB Serial connection
	   -- Connect USB Micro-B side of USB-to-Micro-B cable to the ZedBoard's UART connector (J14)
	   -- Connect USB side to the control PC to enable USB-to-UART bridge.
	-- Connect the AC power adapter
	-- the screen will show the following content:
	------------- Video Library Demo Main Menu: -------------
					-
					1 -> TPG Pattern with No Filter
					2 -> TPG Pattern with Software (OpenCV) Filter
					3 -> TPG Pattern with Software (HLS) Filter
					4 -> TPG Pattern with Hardware Filter
					5 -> Live Video with No Filter
					6 -> Live Video with Software (OpenCV) Filter
					7 -> Live Video with Software (HLS) Filter
					8 -> Live Video with Hardware Filter
					9 -> Decoded Video File with No Filter
					a -> Decoded Video File with Software (OpenCV) Filter
					b -> Decoded Video File with Software (HLS) Filter
					c -> Decoded Video File with Hardware Filter
					p -> Measure Performance (frames per second)
					0 -> Exit
	
	If you don’t see the main menu shown above, press <Enter> twice to force the
	application to re-display the main menu.
	
	If the video_library_cmd application does not start automatically at boot, or if it was
	terminated (by pressing <0> then <Enter>), you will see the PetaLinux console shown
	below.

		The account in the Petalinux:
		Account:  root
		Password: root
		
		Type the following two Linux commands.
		o cd /media/card Enter
		o ./video_library_cmd Enter
		
	Function 1~4 is for test pattern, 5~8 for FMC video input,  9~c for HMDI input. p : cannot measure the 
	different performance between software and hardware.
	
	Type into [8], then you can see the hardware image processing, which is generated by the HLS IP core.

2. Rebuild the whole system.

	In the Windows File Explorer, double click on the following batch file
	hardware_zedboard\Video_Library_Windows.bat
		open the Video_Library_Windows.bat, you need to change the VIVADO software location. like:
			set VIVADO_HLS_HOME=D:\Xilinx\Vivado_HLS\2013.3
			set VIVADO_HOME=D:\Xilinx\Vivado\2013.3
			
--Rebuild the hardware system.
	Create the project with TCL scripts using Vivado Design Suite
	From the command prompt, type the <cd hw/ipi_proj> command, then <Enter>
	From the command prompt, type the < vivado -source scripts\project.tcl >
	command, then <Enter>
		You should see the following output in the console.
			C: \work\hardware_zedboard\cd hw/ipi_proj
			C: \work\hardware_zedboard\hw\ipi_proj>vivado -source scripts\project.tcl
			
	Vivado Design Suite will open, and perform the following steps:
		 Create a Vivado Design Suite project
		 Specify the directory to the IP cores used in the project
		 Create a Vivado IP Integrator (IPI) block diagram
		 Create a HDL wrapper
	
	Note that the project.tcl script calls the following script:
	 build_bd_design.tcl
	If you change the Vivado IPI design, you can re-generate the build_bd_design.tcl
	with the write_bd_tcl command, and still automatically re-generate your modified
	design from TCL scripts !
	
	This is the technique which was used to modify the original XAPP1167 design,
	which supported the ZC702 carrier + HDMI input, for use with the ZedBoard +
	VITA input.
	
--Generate the HLS IP core.
	The HLS code is in the :/root/sw directory. 
	This file contains the HLS code, which can be simulate and synthesized in the Vivado HLS 2013.3

		|-- sw/												 # HLS FILE- generate the IP core
		|   |-- rgb2hsv/                  					 # from rgb to hsv (This one is full version, including synthesized)
		|   |-- rgb2hsv_range/                				 # plus setting the Hin threshold
		|   |-- rgb2hsv_range_erode/           				 # plus erode
		|   |-- rgb2hsv_range_erode_dilate/               	 # plus dilate
		|   |-- rgb2hsv_range_erode_dilate_Gausiblur/        # plus Gausiblur
		|   |-- fast-corner/            					 # Corner-detection design for OpenCV-acceleration
		|   |-- share/                    					 # Shared source files for ARM Linux application

	If want to simulate and synthesized the file other than rgb2hsv, just replace the file [opencv_top.cpp] , [top.cpp] in the rgb2hsv folder.
	Using Vivado HLS 2013 open these application, you can simulate and synthesized. After the synthesized, the IP core in the in folder:
			/root/sw/rgb2hsv/solution1/impl

--Replace the IP core in the Vivado hardware system.
	After generating the HLS IP code, you can put it into the Vivado hardware system,
	Just replace the the the module [image precess -  filer], then synthesize and generate the bitstream file.

	After generating the bitsream file, rename it to [bitsream.bit]
	Copy the system.bit the the folder : hardware_zedboard/boot_image , for the next step generating the sd_image file.
	
--Generating the SD_image file.
	After copying the system.bit the the folder : hardware_zedboard/boot_image , for the next step generating the sd_image file.
	you can using the make file to generate the SD_image file.
	
	In the Windows File Explorer, double click on the following batch file:
		C:\work\hardware_zedboard\Video_Library_Windows.bat
	
	You can build the project in the sw as you like, for example rgb2hsv
		a. in the command type: cd sw/rgb2hsv_range, you should see:
			C:\work\hardware_zedboard\sw\rgb2hsv>>
		b. you can use [make help] to see the function
			C:\work\hardware_zedboard\sw\rgb2hsv>>make help
				Makefile targets of Video Library Reference Design:
				 make elf -- build sw (video_library_cmd)
				 make csim -- run C simulation
				 make cosim -- run RTL simulation
				 make core -- synthesis and export pcore
				 make bitstream -- generate bitstream
				 make boot -- generate boot image (BOOT.bin)
				 make all -- build sw and hw, generate sd_image
				 make clean -- clean generated files of sw and test
				 make allclean -- clean all generated files
				 make help -- give this help
				 
		c. C:\work\hardware_zedboard\sw\rgb2hsv>>make all
			waiting for 20 minutes.
			New sd_image is ready. In the folder C:\work\hardware_zedboard\sw\rgb2hsv\sd_image
			
Ps: 
a. The bitstream file [system_rgb2hsv.bit] and [system_rgb2hsv_range.bit] is provided in the folder
						/hardware_zedboard/boot_image
b.Remember rename the [system_rgb2hsv.bit] and [system_rgb2hsv_range.bit] to system.bit if you want to 
  use the [make all] to rebuild the sd_image.


If just want to execute this project directly, just read the txt file [Execute_directly.txt].
If just want to see the demo, just read the txt file [Demo_video.txt].

//----------------------------------------------------------------
// Author		: Dapeng Lan, Yu Liu
// Description  : This design is based on the XAPP1167 from Xilinx
//                The design was modified for use with the following hardware:
//                - Zedboard (http://zedboard.org)
//                - FMC-IMAGEON - VITA camera (http://www.em.avnet.com/fmc-imageon-v2000c)
//
// Tool Version : Vivado 2013.3 (including Vivado HLS and IP Integrator)
// Known Issues : Design has timing issues which can be ignored
// Revision     : July 29, 2015 : Initial Zedboard + VITA version of design
//----------------------------------------------------------------

This readme file contains these sections:

1. SOFTWARE TOOLS AND HARDWARE REQUIREMENTS
2. DESIGN FILE HIERARCHY
3. INSTALLATION AND OPERATING INSTRUCTIONS


1. SOFTWARE TOOLS AND HARDWARE REQUIREMENTS
============================================

Software:
  -- Vivado Design Suite, System Edition (include Vivado HLS), version 2013.3
  -- Proper installation of required license files for the TRD.
  -- Zedboard board uses CP210x USB to UART Bridge. 
     To use this feature, hyper terminal, Minicom, teraterm or equivalent
     terminal software on the host machine is required. 

Hardware:
  -- ZedBoard (http://zedboard.org)
  -- FMC-IMAGEON module with VITA camera (http://em.avnet.com/fmc-imageon-v2000c)
  -- HDMI-to-HDMI or HDMI-to-DVI cable (depending on available Monitor)
  -- Monitor capable of supporting 1080p60!
  -- SD memory card reader for transferring files onto the SD card.


2. DESIGN FILE HIERARCHY
=========================

The directory structure underneath this top-level folder is described 
below:

|-- boot_image/
|   |-- bootgen.sh              # Script to build BOOT.bin
|   |-- bootimage.bif           # Include file names to create boot image
|   |-- system.bit              # Hardware bitstream to configure the FPGA
|   |-- u-boot.elf              # u-boot Boot Loader executable
|   |-- zynq_fsbl.elf           # Zynq First stage boot loader executable
|
|-- hw/
|   |-- ipi_proj/               # Vivado project for reference designs
|
|-- hw_rgb2hsv_synthesized		# Vivado project for reference designs after synthesized
|
|-- opencv_install/
|   |-- arm_Linux/              # OpenCV libraries and header files for ARM
|
|-- zedboard_linaro				# running the linaro on zedboard
|
|-- SDK/						# SDK file for this Vivado project
|
|-- sd_image/
|   |-- sd_image_rgb2hsv        #change the image format from rgb to hsv
|   |-- sd_image_rgb2hsv_range  #change the image format from rgb to hsv, set Hin threshold,  
								 remove anything not red
|   |-- sd_image_rgb2hsv_range_erode
								#change the image format from rgb to hsv, set Hin threshold, 
								 remove anything not red,then erode the image.
|   |-- sd_image_fastC			#fast corner detection (backup for other image process)
|
		every sd_image file contains the following file:
	    |-- BOOT.bin            # Zynq Boot Image, which is created from 
	    |                             FSBL, hardware bitstream and u-boot
	    |-- image.ub            # PetaLinux image file
	    |-- input_video         # Input video file
	    |-- video_library_cmd   # Cmd line based Linux application executable
|
|-- sw/							# HLS FILE- generate the IP core
|   |-- rgb2hsv/                  					 # from rgb to hsv (This one is full version, incuding sythesis)
|   |-- rgb2hsv_range/                				 # plus setting the Hin threshold
|   |-- rgb2hsv_range_erode/           				 # plus erode
|   |-- rgb2hsv_range_erode_dilate/               	 # plus dilate
|   |-- rgb2hsv_range_erode_dilate_Gausiblur/        # plus Gausiblur
|   |-- fast-corner/            					 # Corner-detection design for OpenCV-acceleration
|   |-- share/                    					 # Shared source files for ARM Linux application
|
|-- README.txt                  # This file
|
|-- Video_Library_Windows.bat   # The batch file to start TRD on Windows



3. INSTALLATION AND OPERATING INSTRUCTIONS 
===========================================

ZedBoard Initial Setup:
----------------------

-- Connect FMC-IMAGEON module on ZedBoard's FMC connector (J1).
-- Configure ZedBoard for SD card boot mode
   JP7 : MIO2 = GND
   JP8 : MIO3 = GND
   JP9 : MIO4 = VCC
   JP10: MIO5 = VCC
   JP11: MIO6 = GND
-- Connect Video Input Source
   -- Connect VITA-2000 camera module to FMC-IMAGEON's LCEDI connector (CONN200)
-- Connect 1080P60 capable monitor
   -- Connect one end of HDMI cable to ZedBoard's HDMI OUT connector (J9)
   -- Connect the other end of HDMI cable to the monitor's HDMI or DVI input
-- Connect USB cable for USB Serial connection
   -- Connect USB Micro-B side of USB-to-Micro-B cable to the ZedBoard's UART connector (J14)
   -- Connect USB side to the control PC to enable USB-to-UART bridge.
-- Connect the AC power adapter

Building Design:
----------------
Using Video_Library_Windows.bat   # The batch file to start TRD on Windows

To enable easily building the reference designs, a Makefile is also provided 
with the following targets:
   'make elf'       -- build sw (video_library_cmd)
   'make sim'       -- build and run csim test
   'make core'      -- synthesis and export IP
   'make bitstream' -- generate bistream (system.bit)
   'make boot'      -- generate boot image (BOOT.bin)
   'make all'       -- build sw and hw, generate sd_image

Running 'make all' from the Linux command line or the Vivado HLS Command Prompt 
under Windows that launched by provided batch file rebuilds the entire design 
and generates an SD card image that can be run. Detailed instructions to Build 
Hardware and Software for this TRD are provided in XAPP1167.

The pre compiled files in sd_image directory can be loaded on SD card root
to get started with the design. Here various options can be explored.

